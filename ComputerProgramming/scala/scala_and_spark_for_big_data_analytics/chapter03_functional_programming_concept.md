# 3장 함수형 프로그래밍 개념
스칼라와 스파크의 사용은 빅데이터 분석을 배우기 위한 아주 좋은 조합이다.
그러나 **결국은 데이터르 분석하는 스파크 애플리케이션을 작성하려면 OOP 패러다임과 함께 함수형 개념이 왜 중요한지 알아야 한다.**

## 함수형 프로그래밍 소개
* 컴퓨터 프로그램의 구조와 엘리먼트를 구축한 독창적인 스타일이다.
* 이 독창성은 계산을 수학 함수의 평가로 간주하고 상태 변경과 가변 데이터를 방지한다.
* 따라서 FP 개념을 사용해 데이터의 불변성을 보장하는 사용자 정의 스타일로 코드를 작성하는 방법을 배울 수 있다.

* 즉 FP는 가능한 한 숨겨진 입력과 출력을 제거하는 순수 함수를 작성하는 것이기 때문에 **코드의 대부분은 가능한 한 입력과 출력 간의 관계를 설명한다.**

### 함수형 프로그래밍의 장점
함수형 프로그래밍에서 각 함수는 동일한 매핑 또는 입력 파라미터 값에 대한 출력을 갖는다.

#### 복잡한 소프트웨어에서 필요한 것은 
* 코드 작성과 디버깅하기 어렵지 않은 좋은 구조의 프로그램과 소프트웨어다.
* 또한 향후 프로그래밍 비용을 절감하고 코드를 쉽게 작성하고 디버깅할 수 있는 확장 가능한 코드를 작성해야 한다.
    
#### FP개념의 장점
* 수학적 사고에 밀접하다
* 어떠한(또는 적어도 최소한의) 부수 효과가 없다.
* 개념 선명도가 희생되지 않는 적은 수의 코드 라인

----
## 데이터 과학자를 위한 함수형 스칼라

## 스파크를 공부하는 데 FP와 스칼라를 설명하는 이유

### 스파크인 이유
* 스파크는 하둡 맵리듀스 모델을 기반으로 하고, 대화형 쿼리와 스트림 처리 같은 계산의 여려 형태와 타입에서 맵 리듀스를 사용한다.
* 스파크의 주요 기능중 하나는 애플리케이션의 성능과 처리 속도를 향상시켜주는 인메모리 처리 방식이다.
* 스파크는 다양한 애플리케이션과 작업 부하를 지원한다.
  * 배치 기반 애플리케이션
  * 이전에 빠르게 실행할 수 없었던 반복 알고리즘
  * 대화식 쿼리와 스트리밍

#### 아파치 스파크를 유명하게 한 특징
* 빠른 계산
* 다중 프로그래밍 언어 지원
* 고급 분석

#### 스파크의 배포 방식
* 독립형(Stand alone) 클러스터
* 하둡 얀(YARN) 클러스터
* 메소스(Msos) 클러스터
* 상용 클라우드 클러스터에 배포

### 스칼라와 스파크 프로그래밍 모델
스파크가 제공하는 일반적인 RDD 프로그래밍 모델
* 환경 변수에서 스파크 컨텐스트는 초기 데이터 참조 RDD 객체를 생성한다.
* 초기 RDD를 변환해 함수형 프로그래밍 스타일에 따르는 많은 RDD 객체를 생성한다.
* 드라이버 프로그램의 코드, 알고리즘, 애플리케이션을 클러스터 관리자 노드로 보낸다.
* 컴퓨팅 노드는 컴퓨팅 노드의 파티션에 있는 RDD에 대한 참조를 갖고 있다. 그러나 컴퓨팅 노드에 클러스터 관리자가 제공한 입력 데이터셋을 갖고 있을 수도 있다.
* 트랜스포메이션후 생성된 결과는 원래의 RDD가 불변이기 때문에 완전히 새로운 RDD다.
* 마지막으로 RDD객체는 RDD를 저장소로 덤프하는 작업을 통해 실체화된다.
* 드라이버 프로그램은 컴퓨팅 노드에 프로그램의 분석 또는 시각화를 위해 결과 데이터를 요청할 수 있다.

### 스칼라와 스파크 생태계
스파크 생태계를 구성하는 컴포넌트
* 아파치 스파크 코어
* 스파크 SQL
* 스파크 스트리밍
* MLlib(Machine Learning Library)
* GraphX

----
## 순수 함수와 고차 함수

### 순수 함수 
순수 함수의 장점

* 일반적으로 일반함수보다 작지만, 수학 함수처럼 보이기 때문에 인간의 두뇌를 더 쉽게 해석하고 이해할 수 있다.
* 순수 함수는 구현 및 테스트가 훨씬 쉽다.

### 익명 함수
> 예제코드

    def TransferMoney(money: Double, bankFee: Double => Double): Double = {
        money + bankFee(money)
    }

    TransferMoney(100, (amount: Double) => amount * 0.05)

### 고차 함수
함수를 파라미터로 전달할 수 있고, 함수의 결과로 함수를 리턴할 수도 있다.
이를 고차 함수라 정의한다.

#### 콜백함수
콜백 함수는 어떤 함수에 파라미터로 전달될 수 있는 함수다.
콜백 함수를 사용해 고차 함수에 추가적인 능력을 보탤 수 있다.
따라서 콜백 함수는 프로그램을 더 우아하고 유연하며 효율적으로 만들어주는 매우 강력한 메커니즘이다.

### 함수를 리턴 값으로 사용


----
## 고차 함수 사용


### 커링(currying)
### 언커링(uncurrying)

----
## 함수형 스칼라의 에러 핸들링

### 스칼라의 실패와 예외
#### 일반적인 '실패'의 의미를 정리
* 예기치 않은 내부 에러
* 예상되는 내부 에러
* 예상되는 외부 에러
* 예기치 않은 외부 에러

----
#### 스칼라의 예외 
* 스칼라는 예외를 처리돼야 할 예외(checked exception)와 처리되지 않아도 되는 예외(unchecked exceptions)처럼 매우 단순히 생성한다.
* 즉, 스칼라에서는 처리돼야 할 예외가 없다. 
* 스칼라의 모든 예외는 처리되지 않아도 되는 예외다.

### 예외 던지기

### try와 catch를 사용한 예외 처리

### finally

### Either 생성 

### Future

### 하나의 태스크를 실행하고 대기
* Future
* Await


----
## 함수형 프로그래밍과 데이터 가변성
**순수 함수형 프로그래밍은 함수형 프로그래밍의 모범 사례 중 하나며 반드시 사용해야 한다.**

> 순수 함수를 작성하면
**프로그래밍을 쉽게 할 수 있고 유지 보수 및 확장이 쉬운 코드를 작성할 수 있다.**
또한 **코드를 병렬화하려면 순수 함수를 작성하는 것이 훨씬 쉽다**


----
## 요약
### 3장에서는 스칼라의 함수형 프로그래밍 개념을 살펴봤다.
* 함수형 프로그래밍이 무엇인지
* 스칼라가 함수형 프로그래밍을 어떻게 지원하는지, 왜 중요한지, 함수형 개념을 사용하는 장점
* 스파크 패러다임을 배우는 과정에서 FP 개념을 배우는 것이 중요한 이유를 다루었다.
